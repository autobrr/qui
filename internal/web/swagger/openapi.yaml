openapi: 3.1.0
info:
  title: qui API
  description: qui API for managing multiple qBittorrent instances
  version: 1.0.0
  license:
    name: GPL-2.0-or-later
    url: https://opensource.org/licenses/GPL-2.0

servers:
  - url: http://localhost:7476
    description: Local development server
  - url: /
    description: Current server

security:
  - ApiKeyAuth: []
  - SessionAuth: []

paths:
  /api/auth/setup:
    post:
      tags:
        - Authentication
      summary: Initial setup
      description: Create the initial admin user (only available before first user is created)
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  type: string
                  minLength: 1
                password:
                  type: string
                  minLength: 8
                  writeOnly: true
                  description: Password will be hashed and never returned in responses
      responses:
        '201':
          description: Setup completed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  user:
                    $ref: '#/components/schemas/User'
        '400':
          description: Setup already completed

  /api/auth/login:
    post:
      tags:
        - Authentication
      summary: Login
      description: Authenticate with username and password
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  type: string
                password:
                  type: string
                  writeOnly: true
                  description: Password will be hashed and never returned in responses
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  user:
                    $ref: '#/components/schemas/User'
        '401':
          description: Invalid credentials

  /api/auth/check-setup:
    get:
      tags:
        - Authentication
      summary: Check setup status
      description: Check if initial setup is required
      security: []
      responses:
        '200':
          description: Setup status
          content:
            application/json:
              schema:
                type: object
                properties:
                  setupRequired:
                    type: boolean

  /api/auth/logout:
    post:
      tags:
        - Authentication
      summary: Logout
      description: End the current session
      responses:
        '200':
          description: Logged out successfully

  /api/auth/me:
    get:
      tags:
        - Authentication
      summary: Get current user
      description: Get information about the authenticated user
      responses:
        '200':
          description: Current user information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'

  /api/auth/change-password:
    put:
      tags:
        - Authentication
      summary: Change password
      description: Change the current user's password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - currentPassword
                - newPassword
              properties:
                currentPassword:
                  type: string
                  writeOnly: true
                  description: Current password for verification
                newPassword:
                  type: string
                  minLength: 8
                  writeOnly: true
                  description: New password will be hashed and never returned in responses
      responses:
        '200':
          description: Password changed successfully
        '401':
          description: Invalid current password

  /api/api-keys:
    get:
      tags:
        - API Keys
      summary: List API keys
      description: Get all API keys for the current user
      responses:
        '200':
          description: List of API keys
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ApiKey'
    post:
      tags:
        - API Keys
      summary: Create API key
      description: Generate a new API key
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Descriptive name for the API key
      responses:
        '201':
          description: API key created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  name:
                    type: string
                  key:
                    type: string
                    description: The API key (only shown once)
                  createdAt:
                    type: string
                    format: date-time
                  message:
                    type: string

  /api/api-keys/{id}:
    delete:
      tags:
        - API Keys
      summary: Delete API key
      description: Revoke an API key
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: API key deleted successfully
        '404':
          description: API key not found

  /api/client-api-keys:
    get:
      tags:
        - Client API Keys
      summary: List client API keys
      description: Get all client API keys for external applications
      responses:
        '200':
          description: List of client API keys
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ClientApiKey'
    post:
      tags:
        - Client API Keys
      summary: Create client API key
      description: Generate a new client API key for external applications
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - clientName
                - instanceId
              properties:
                clientName:
                  type: string
                  description: Name of the client application (e.g., "Sonarr")
                instanceId:
                  type: integer
                  description: ID of the qBittorrent instance to proxy to
      responses:
        '201':
          description: Client API key created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  clientName:
                    type: string
                  instanceId:
                    type: integer
                  key:
                    type: string
                    description: The client API key (only shown once)
                  createdAt:
                    type: string
                    format: date-time
                  message:
                    type: string

  /api/client-api-keys/{id}:
    delete:
      tags:
        - Client API Keys
      summary: Delete client API key
      description: Revoke a client API key
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Client API key deleted successfully
        '404':
          description: Client API key not found

  /api/instances:
    get:
      tags:
        - Instances
      summary: List instances
      description: Get all configured qBittorrent instances
      responses:
        '200':
          description: List of instances
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Instance'
    post:
      tags:
        - Instances
      summary: Add instance
      description: Add a new qBittorrent instance
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - host
                - username
                - password
              properties:
                name:
                  type: string
                host:
                  type: string
                  format: uri
                username:
                  type: string
                password:
                  type: string
                  writeOnly: true
                  description: Password for qBittorrent instance. Will be encrypted and never returned in responses.
                basicUsername:
                  type: string
                  nullable: true
                  description: Optional basic auth username
                basicPassword:
                  type: string
                  nullable: true
                  writeOnly: true
                  description: Optional basic auth password. Will be encrypted and never returned in responses.
                tlsSkipVerify:
                  type: boolean
                  description: Set to true to disable TLS certificate verification (for trusted self-signed certificates).
      responses:
        '201':
          description: Instance created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Instance'

  /api/instances/{instanceId}:
    put:
      tags:
        - Instances
      summary: Update instance
      description: Update instance configuration
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                host:
                  type: string
                  format: uri
                username:
                  type: string
                password:
                  type: string
                  writeOnly: true
                  description: Password for qBittorrent instance. Optional for updates - only updates if provided and not masked.
                basicUsername:
                  type: string
                  nullable: true
                  description: Optional basic auth username
                basicPassword:
                  type: string
                  nullable: true
                  writeOnly: true
                  description: Optional basic auth password. For updates - provide new password to update, omit field to keep existing, or empty string to remove basic auth.
                tlsSkipVerify:
                  type: boolean
                  description: Set to true to disable TLS certificate verification (for trusted self-signed certificates).
      responses:
        '200':
          description: Instance updated
    delete:
      tags:
        - Instances
      summary: Delete instance
      description: Remove a qBittorrent instance
      parameters:
        - $ref: '#/components/parameters/instanceId'
      responses:
        '204':
          description: Instance deleted
        '404':
          description: Instance not found

  /api/instances/{instanceId}/test:
    post:
      tags:
        - Instances
      summary: Test connection
      description: Test connection to a qBittorrent instance
      parameters:
        - $ref: '#/components/parameters/instanceId'
      responses:
        '200':
          description: Connection successful
        '503':
          description: Connection failed


  /api/instances/{instanceId}/torrents:
    get:
      tags:
        - Torrents
      summary: List torrents
      description: Get paginated list of torrents
      parameters:
        - $ref: '#/components/parameters/instanceId'
        - name: page
          in: query
          schema:
            type: integer
            default: 0
        - name: limit
          in: query
          schema:
            type: integer
            default: 500
            maximum: 2000
        - name: sort
          in: query
          schema:
            type: string
            enum: [name, size, progress, priority, added_on]
        - name: order
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: desc
        - name: search
          in: query
          schema:
            type: string
        - name: filters
          in: query
          schema:
            type: string
            description: JSON object with filter criteria
      responses:
        '200':
          description: Paginated torrent list
          content:
            application/json:
              schema:
                type: object
                properties:
                  torrents:
                    type: array
                    items:
                      $ref: '#/components/schemas/Torrent'
                  total:
                    type: integer
                  page:
                    type: integer
                  limit:
                    type: integer
    post:
      tags:
        - Torrents
      summary: Add torrent
      description: Add a new torrent via file upload or magnet link
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                torrentFile:
                  type: string
                  format: binary
                urls:
                  type: array
                  items:
                    type: string
                category:
                  type: string
                tags:
                  type: array
                  items:
                    type: string
                startPaused:
                  type: boolean
                savePath:
                  type: string
      responses:
        '201':
          description: Torrent added successfully


  /api/instances/{instanceId}/torrents/bulk-action:
    post:
      tags:
        - Torrents
      summary: Bulk torrent action
      description: Perform bulk actions on multiple torrents
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - action
              properties:
                hashes:
                  type: array
                  items:
                    type: string
                  description: Specific torrent hashes to target. Required unless selectAll is true.
                selectAll:
                  type: boolean
                  description: Apply the action to all torrents matching the provided filters.
                filters:
                  type: object
                  description: Filter criteria used when selectAll is true.
                  properties:
                    status:
                      type: array
                      items:
                        type: string
                    categories:
                      type: array
                      items:
                        type: string
                    tags:
                      type: array
                      items:
                        type: string
                    trackers:
                      type: array
                      items:
                        type: string
                search:
                  type: string
                  description: Optional search query applied when selectAll is true.
                excludeHashes:
                  type: array
                  items:
                    type: string
                  description: Hashes to exclude when selectAll is true.
                action:
                  type: string
                  description: Bulk action to perform on the selected torrents.
                  enum:
                    - pause
                    - resume
                    - delete
                    - deleteWithFiles
                    - recheck
                    - reannounce
                    - increasePriority
                    - decreasePriority
                    - topPriority
                    - bottomPriority
                    - addTags
                    - removeTags
                    - setTags
                    - setCategory
                    - toggleAutoTMM
                    - setShareLimit
                    - setUploadLimit
                    - setDownloadLimit
                    - setLocation
                    - editTrackers
                    - addTrackers
                    - removeTrackers
                deleteFiles:
                  type: boolean
                  description: Only for delete action
                tags:
                  type: string
                  description: Comma-separated list of tags for tag-related actions.
                category:
                  type: string
                  description: Category name for setCategory action.
                enable:
                  type: boolean
                  description: Enable or disable Automatic Torrent Management for toggleAutoTMM.
                ratioLimit:
                  type: number
                  format: float
                  description: Ratio limit for setShareLimit action.
                seedingTimeLimit:
                  type: integer
                  format: int64
                  description: Seeding time limit (minutes) for setShareLimit action.
                inactiveSeedingTimeLimit:
                  type: integer
                  format: int64
                  description: Inactive seeding time limit (minutes) for setShareLimit action.
                uploadLimit:
                  type: integer
                  format: int64
                  description: Upload speed limit in KB/s for setUploadLimit action.
                downloadLimit:
                  type: integer
                  format: int64
                  description: Download speed limit in KB/s for setDownloadLimit action.
                location:
                  type: string
                  description: Destination path for setLocation action.
                trackerOldURL:
                  type: string
                  description: Existing tracker URL to replace for editTrackers action.
                trackerNewURL:
                  type: string
                  description: Replacement tracker URL for editTrackers action.
                trackerURLs:
                  type: string
                  description: Newline-separated tracker URLs for addTrackers/removeTrackers actions.
      responses:
        '200':
          description: Action performed successfully


  /api/instances/{instanceId}/torrents/{hash}/properties:
    get:
      tags:
        - Torrent Details
      summary: Get torrent properties
      description: Get detailed properties of a torrent
      parameters:
        - $ref: '#/components/parameters/instanceId'
        - $ref: '#/components/parameters/hash'
      responses:
        '200':
          description: Torrent properties
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TorrentProperties'

  /api/instances/{instanceId}/torrents/{hash}/trackers:
    get:
      tags:
        - Torrent Details
      summary: Get torrent trackers
      description: Get list of trackers for a torrent
      parameters:
        - $ref: '#/components/parameters/instanceId'
        - $ref: '#/components/parameters/hash'
      responses:
        '200':
          description: List of trackers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Tracker'
    put:
      tags:
        - Torrent Details
      summary: Edit torrent tracker
      description: Edit a tracker URL for a torrent
      parameters:
        - $ref: '#/components/parameters/instanceId'
        - $ref: '#/components/parameters/hash'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - oldURL
                - newURL
              properties:
                oldURL:
                  type: string
                  description: The current tracker URL to replace
                newURL:
                  type: string
                  description: The new tracker URL
      responses:
        '200':
          description: Tracker edited successfully
        '400':
          description: Invalid request
        '500':
          description: Failed to edit tracker
    post:
      tags:
        - Torrent Details
      summary: Add torrent trackers
      description: Add new trackers to a torrent
      parameters:
        - $ref: '#/components/parameters/instanceId'
        - $ref: '#/components/parameters/hash'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - urls
              properties:
                urls:
                  type: string
                  description: Newline-separated list of tracker URLs to add
      responses:
        '200':
          description: Trackers added successfully
        '400':
          description: Invalid request
        '500':
          description: Failed to add trackers
    delete:
      tags:
        - Torrent Details
      summary: Remove torrent trackers
      description: Remove trackers from a torrent
      parameters:
        - $ref: '#/components/parameters/instanceId'
        - $ref: '#/components/parameters/hash'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - urls
              properties:
                urls:
                  type: string
                  description: Newline-separated list of tracker URLs to remove
      responses:
        '200':
          description: Trackers removed successfully
        '400':
          description: Invalid request
        '500':
          description: Failed to remove trackers

  /api/instances/{instanceId}/torrents/{hash}/files:
    get:
      tags:
        - Torrent Details
      summary: Get torrent files
      description: Get list of files in a torrent
      parameters:
        - $ref: '#/components/parameters/instanceId'
        - $ref: '#/components/parameters/hash'
      responses:
        '200':
          description: List of files
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TorrentFile'

  /api/instances/{instanceId}/torrents/{hash}/peers:
    get:
      tags:
        - Torrent Details
      summary: Get torrent peers
      description: Get list of peers for a torrent
      parameters:
        - $ref: '#/components/parameters/instanceId'
        - $ref: '#/components/parameters/hash'
      responses:
        '200':
          description: List of peers
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    ip:
                      type: string
                    port:
                      type: integer
                    client:
                      type: string
                    progress:
                      type: number
                    dlSpeed:
                      type: integer
                    upSpeed:
                      type: integer
                    downloaded:
                      type: integer
                    uploaded:
                      type: integer
                    connection:
                      type: string
                    flags:
                      type: string
                    flagsDesc:
                      type: string
                    relevance:
                      type: number

  /api/instances/{instanceId}/torrents/add-peers:
    post:
      tags:
        - Torrents
      summary: Add peers to torrents
      description: Add peers to one or more torrents
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - hashes
                - peers
              properties:
                hashes:
                  type: array
                  items:
                    type: string
                  description: List of torrent hashes
                peers:
                  type: array
                  items:
                    type: string
                  description: List of peers in host:port format
      responses:
        '200':
          description: Peers added successfully

  /api/instances/{instanceId}/torrents/ban-peers:
    post:
      tags:
        - Torrents
      summary: Ban peers permanently
      description: Ban peers from connecting to the client
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - peers
              properties:
                peers:
                  type: array
                  items:
                    type: string
                  description: List of peer IPs to ban
      responses:
        '200':
          description: Peers banned successfully

  /api/instances/{instanceId}/categories:
    get:
      tags:
        - Categories
      summary: List categories
      description: Get all categories
      parameters:
        - $ref: '#/components/parameters/instanceId'
      responses:
        '200':
          description: List of categories
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Category'
    post:
      tags:
        - Categories
      summary: Create category
      description: Create a new category
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                savePath:
                  type: string
      responses:
        '201':
          description: Category created
    put:
      tags:
        - Categories
      summary: Edit category
      description: Edit an existing category
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                savePath:
                  type: string
      responses:
        '200':
          description: Category updated
    delete:
      tags:
        - Categories
      summary: Delete categories
      description: Delete one or more categories
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - categories
              properties:
                categories:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Categories deleted

  /api/instances/{instanceId}/tags:
    get:
      tags:
        - Tags
      summary: List tags
      description: Get all tags
      parameters:
        - $ref: '#/components/parameters/instanceId'
      responses:
        '200':
          description: List of tags
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
    post:
      tags:
        - Tags
      summary: Create tags
      description: Create new tags
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tags
              properties:
                tags:
                  type: array
                  items:
                    type: string
      responses:
        '201':
          description: Tags created
    delete:
      tags:
        - Tags
      summary: Delete tags
      description: Delete one or more tags
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tags
              properties:
                tags:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Tags deleted

  /api/instances/{instanceId}/preferences:
    get:
      tags:
        - Instances
      summary: Get instance preferences
      description: Get qBittorrent instance preferences/settings
      parameters:
        - $ref: '#/components/parameters/instanceId'
      responses:
        '200':
          description: Instance preferences
          content:
            application/json:
              schema:
                type: object
                description: qBittorrent preferences object with various settings
    patch:
      tags:
        - Instances
      summary: Update instance preferences
      description: Update qBittorrent instance preferences/settings
      parameters:
        - $ref: '#/components/parameters/instanceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Partial preferences object with settings to update
      responses:
        '200':
          description: Preferences updated successfully

  /api/instances/{instanceId}/alternative-speed-limits:
    get:
      tags:
        - Instances
      summary: Get alternative speed limits status
      description: Get current status of alternative speed limits (turtle mode)
      parameters:
        - $ref: '#/components/parameters/instanceId'
      responses:
        '200':
          description: Alternative speed limits status
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
                    description: Whether alternative speed limits are currently enabled

  /api/instances/{instanceId}/alternative-speed-limits/toggle:
    post:
      tags:
        - Instances
      summary: Toggle alternative speed limits
      description: Toggle alternative speed limits (turtle mode) on/off
      parameters:
        - $ref: '#/components/parameters/instanceId'
      responses:
        '200':
          description: Alternative speed limits toggled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
                    description: New status of alternative speed limits

  /api/license/activate:
    post:
      tags:
        - Licenses
      summary: Activate license
      description: Activate a license key and store it for the current user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - licenseKey
              properties:
                licenseKey:
                  type: string
      responses:
        '200':
          description: License activated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid:
                    type: boolean
                  productName:
                    type: string
                  expiresAt:
                    type: string
                    format: date-time
                  message:
                    type: string
                  error:
                    type: string
                    nullable: true
        '400':
          description: Invalid request payload
        '403':
          description: License activation failed

  /api/license/validate:
    post:
      tags:
        - Licenses
      summary: Validate license
      description: Validate a license key and ensure it remains active
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - licenseKey
              properties:
                licenseKey:
                  type: string
      responses:
        '200':
          description: License validated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid:
                    type: boolean
                  productName:
                    type: string
                  expiresAt:
                    type: string
                    format: date-time
                  message:
                    type: string
                  error:
                    type: string
                    nullable: true
        '400':
          description: Invalid request payload
        '403':
          description: License validation failed
        '404':
          description: License not found

  /api/license/licensed:
    get:
      tags:
        - Licenses
      summary: Check premium access
      description: Check if any active licenses grant premium access
      responses:
        '200':
          description: Premium access status
          content:
            application/json:
              schema:
                type: object
                properties:
                  hasPremiumAccess:
                    type: boolean

  /api/license/licenses:
    get:
      tags:
        - Licenses
      summary: List licenses
      description: List all stored licenses
      responses:
        '200':
          description: Licenses retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    licenseKey:
                      type: string
                    productName:
                      type: string
                    status:
                      type: string
                    createdAt:
                      type: string
                      format: date-time

  /api/license/{licenseKey}:
    delete:
      tags:
        - Licenses
      summary: Delete license
      description: Remove a stored license
      parameters:
        - name: licenseKey
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: License deleted successfully
        '400':
          description: Invalid license key

  /api/license/refresh:
    post:
      tags:
        - Licenses
      summary: Refresh licenses
      description: Refresh all stored licenses from the licensing service
      responses:
        '200':
          description: Licenses refreshed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '500':
          description: Failed to refresh licenses

  /api/version/latest:
    get:
      tags:
        - System
      summary: Check for latest version
      description: Check if a newer version of qui is available
      responses:
        '200':
          description: Update available - newer version found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LatestVersionResponse'
        '204':
          description: No update available - current version is latest

  /health:
    get:
      tags:
        - System
      summary: Health check
      description: Check if the API is healthy and responding
      security: []
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"

  /healthz/readiness:
    get:
      tags:
        - System
      summary: Readiness probe
      description: Check if the service and its dependencies are ready to receive traffic
      security: []
      responses:
        '200':
          description: Service ready
        '503':
          description: Service not ready

  /healthz/liveness:
    get:
      tags:
        - System
      summary: Liveness probe
      description: Simple liveness check to confirm the service is running
      security: []
      responses:
        '200':
          description: Service is alive


components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for authentication
    SessionAuth:
      type: apiKey
      in: cookie
      name: user_session
      description: Session cookie authentication

  parameters:
    instanceId:
      name: instanceId
      in: path
      required: true
      schema:
        type: integer
      description: qBittorrent instance ID
    hash:
      name: hash
      in: path
      required: true
      schema:
        type: string
      description: Torrent hash

  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
        username:
          type: string

    ApiKey:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        createdAt:
          type: string
          format: date-time
        lastUsedAt:
          type: string
          format: date-time
          nullable: true

    ClientApiKey:
      type: object
      properties:
        id:
          type: integer
        clientName:
          type: string
          description: Name of the client application
        instanceId:
          type: integer
          description: ID of the qBittorrent instance
        instanceName:
          type: string
          description: Name of the qBittorrent instance
        createdAt:
          type: string
          format: date-time
        lastUsedAt:
          type: string
          format: date-time
          nullable: true

    Instance:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        host:
          type: string
          format: uri
        username:
          type: string
        password:
          type: string
          description: Always masked with asterisks in responses. Only used for input.
          readOnly: true
        basic_username:
          type: string
          nullable: true
        basic_password:
          type: string
          description: Always masked with asterisks in responses. Only used for input.
          readOnly: true
          nullable: true
        is_active:
          type: boolean
        last_connected_at:
          type: string
          format: date-time
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        connected:
          type: boolean
          description: Current connection status
        connectionError:
          type: string
          description: Error message if connection failed
        hasDecryptionError:
          type: boolean
          description: Whether there's a password decryption error
        tlsSkipVerify:
          type: boolean
          description: When true, TLS certificate errors from the upstream qBittorrent instance are ignored.


    Torrent:
      type: object
      properties:
        hash:
          type: string
        name:
          type: string
        size:
          type: integer
        progress:
          type: number
        dlSpeed:
          type: integer
        upSpeed:
          type: integer
        priority:
          type: integer
        numSeeds:
          type: integer
        numLeechs:
          type: integer
        ratio:
          type: number
        eta:
          type: integer
        state:
          type: string
        category:
          type: string
        tags:
          type: array
          items:
            type: string
        addedOn:
          type: integer
        completedOn:
          type: integer
        savePath:
          type: string

    TorrentProperties:
      type: object
      properties:
        totalDownloaded:
          type: integer
        totalUploaded:
          type: integer
        downloadSpeed:
          type: integer
        uploadSpeed:
          type: integer
        eta:
          type: integer
        seedsActual:
          type: integer
        peersActual:
          type: integer
        shareRatio:
          type: number
        uploadLimit:
          type: integer
        downloadLimit:
          type: integer
        totalSize:
          type: integer
        completedSize:
          type: integer
        additionDate:
          type: integer
        completionDate:
          type: integer
        createdBy:
          type: string
        comment:
          type: string

    Tracker:
      type: object
      properties:
        url:
          type: string
        status:
          type: integer
        tier:
          type: integer
        numPeers:
          type: integer
        numSeeds:
          type: integer
        numLeeches:
          type: integer
        msg:
          type: string

    TorrentFile:
      type: object
      properties:
        name:
          type: string
        size:
          type: integer
        progress:
          type: number
        priority:
          type: integer
        isSeed:
          type: boolean
        availability:
          type: number

    Category:
      type: object
      properties:
        name:
          type: string
        savePath:
          type: string

    LatestVersionResponse:
      type: object
      description: Information about the latest available version when an update is available
      required:
        - tag_name
        - html_url
        - published_at
      properties:
        tag_name:
          type: string
          description: The version tag (e.g., "v1.2.3")
          example: "v1.2.3"
        name:
          type: string
          nullable: true
          description: The release name/title
          example: "qui v1.2.3 - Bug fixes and improvements"
        html_url:
          type: string
          format: uri
          description: URL to the GitHub release page
          example: "https://github.com/autobrr/qui/releases/tag/v1.2.3"
        published_at:
          type: string
          format: date-time
          description: When the release was published
          example: "2025-09-23T10:30:00Z"

tags:
  - name: Authentication
    description: User authentication and session management
  - name: API Keys
    description: API key management
  - name: Client API Keys
    description: Client API key management for external applications
  - name: Instances
    description: qBittorrent instance management
  - name: Torrents
    description: Torrent operations
  - name: Torrent Details
    description: Individual torrent information
  - name: Categories
    description: Category management
  - name: Tags
    description: Tag management
  - name: Theme Licenses
    description: Theme license management (optional feature)
